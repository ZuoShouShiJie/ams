<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.dzjk.ams.dal.mapper.AccountBorrowDOMapper">
    <!-- 自动生成,请修改 AMS_ACCOUNT_BORROW.xml -->
    <resultMap id="BaseResultMap" type="com.dzjk.ams.dal.dataobject.AccountBorrowDO">
        <id column="ID" property="id" jdbcType="BIGINT" javaType="Long"/>
        <result column="BO_ID" property="boId" jdbcType="VARCHAR" javaType="String"/>
        <result column="ORG_ID" property="orgId" jdbcType="BIGINT" javaType="Long"/>
        <result column="STATUS" property="status" jdbcType="VARCHAR" javaType="String"/>
        <result column="USER_ID" property="userId" jdbcType="VARCHAR" javaType="String"/>
        <result column="CHANNEL" property="channel" jdbcType="VARCHAR" javaType="String"/>
        <result column="BR_USER_ID" property="brUserId" jdbcType="VARCHAR" javaType="String"/>
        <result column="LEND_TIME" property="lendTime" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        <result column="RATE_TYPE" property="rateType" jdbcType="VARCHAR" javaType="String"/>
        <result column="APPLY_TIME" property="applyTime" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        <result column="CREATED_BY" property="createdBy" jdbcType="VARCHAR" javaType="String"/>
        <result column="IS_FULL_FEE" property="isFullFee" jdbcType="VARCHAR" javaType="String"/>
        <result column="LOAN_USAGE" property="loanUsage" jdbcType="VARCHAR" javaType="String"/>
        <result column="REPAY_DATE" property="repayDate" jdbcType="VARCHAR" javaType="String"/>
        <result column="REPAY_RATE" property="repayRate" jdbcType="VARCHAR" javaType="String"/>
        <result column="REPAY_TYPE" property="repayType" jdbcType="VARCHAR" javaType="String"/>
        <result column="UPDATED_BY" property="updatedBy" jdbcType="VARCHAR" javaType="String"/>
        <result column="CONTRACT_NO" property="contractNo" jdbcType="VARCHAR" javaType="String"/>
        <result column="LEND_AMOUNT" property="lendAmount" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="LOAN_AMOUNT" property="loanAmount" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="APPROVE_TIME" property="approveTime" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        <result column="CREATED_TIME" property="createdTime" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        <result column="PRODUCT_CODE" property="productCode" jdbcType="VARCHAR" javaType="String"/>
        <result column="PRODUCT_TYPE" property="productType" jdbcType="VARCHAR" javaType="String"/>
        <result column="RECEIPT_RATE" property="receiptRate" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="REPAY_PERIOD" property="repayPeriod" jdbcType="VARCHAR" javaType="String"/>
        <result column="REPAY_STATUS" property="repayStatus" jdbcType="VARCHAR" javaType="String"/>
        <result column="UPDATED_TIME" property="updatedTime" jdbcType="TIMESTAMP" javaType="java.util.Date"/>
        <result column="CONTRACT_TYPE" property="contractType" jdbcType="VARCHAR" javaType="String"/>
        <result column="INTEREST_ACCU" property="interestAccu" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="OVERDUE_TIMES" property="overdueTimes" jdbcType="VARCHAR" javaType="String"/>
        <result column="PLATFORM_RATE" property="platformRate" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="ACCOUNT_AMOUNT" property="accountAmount" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="CAPITAL_AMOUNT" property="capitalAmount" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="LAST_REPAY_DATE" property="lastRepayDate" jdbcType="DATE" javaType="java.util.Date"/>
        <result column="MAX_OVERDUE_DAY" property="maxOverdueDay" jdbcType="VARCHAR" javaType="String"/>
        <result column="NEXT_REPAY_DATE" property="nextRepayDate" jdbcType="DATE" javaType="java.util.Date"/>
        <result column="APPROVE_DATE" property="approveDate" jdbcType="DATE" javaType="java.util.Date"/>
        <result column="LEND_DATE" property="lendDate" jdbcType="DATE" javaType="java.util.Date"/>


        <result column="PUNISH_FEE_ACCU" property="punishFeeAccu" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="REPAY_ACCT_BANK" property="repayAcctBank" jdbcType="VARCHAR" javaType="String"/>
        <result column="CAPITAL_ADVANCE" property="capitalAdvance" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="CONTRACT_AMOUNT" property="contractAmount" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="CURR_OVERDUE_DAY" property="currOverdueDay" jdbcType="VARCHAR" javaType="String"/>
        <result column="FIRST_REPAY_DATE" property="firstRepayDate" jdbcType="DATE" javaType="java.util.Date"/>
        <result column="REPAY_ACCOUNT_NO" property="repayAccountNo" jdbcType="VARCHAR" javaType="String"/>
        <result column="REPAY_ACCT_PHONE" property="repayAcctPhone" jdbcType="VARCHAR" javaType="String"/>
        <result column="SERVICE_FEE_ACCU" property="serviceFeeAccu" jdbcType="DECIMAL" javaType="java.math.BigDecimal"/>
        <result column="INTEREST_ADVANCE" property="interestAdvance" jdbcType="DECIMAL"
                javaType="java.math.BigDecimal"/>
        <result column="REPAY_ACCOUNT_NAME" property="repayAccountName" jdbcType="VARCHAR" javaType="String"/>
        <result column="TOTAL_CAPITAL_ACCU" property="totalCapitalAccu" jdbcType="DECIMAL"
                javaType="java.math.BigDecimal"/>
        <result column="TOTAL_CAPITAL_LEFT" property="totalCapitalLeft" jdbcType="DECIMAL"
                javaType="java.math.BigDecimal"/>
        <result column="REPAY_FLOATING_RATE" property="repayFloatingRate" jdbcType="DECIMAL"
                javaType="java.math.BigDecimal"/>
    </resultMap>


    <sql id="Base_Column_List">
        ID,BO_ID,ORG_ID,STATUS,USER_ID,CHANNEL,BR_USER_ID,LEND_TIME,RATE_TYPE,APPLY_TIME,CREATED_BY,IS_FULL_FEE,LOAN_USAGE,REPAY_DATE,REPAY_RATE,REPAY_TYPE,UPDATED_BY,CONTRACT_NO,LEND_AMOUNT,LOAN_AMOUNT,APPROVE_TIME,CREATED_TIME,PRODUCT_CODE,PRODUCT_TYPE,RECEIPT_RATE,REPAY_PERIOD,REPAY_STATUS,UPDATED_TIME,CONTRACT_TYPE,INTEREST_ACCU,OVERDUE_TIMES,PLATFORM_RATE,ACCOUNT_AMOUNT,CAPITAL_AMOUNT,LAST_REPAY_DATE,MAX_OVERDUE_DAY,NEXT_REPAY_DATE,PUNISH_FEE_ACCU,REPAY_ACCT_BANK,CAPITAL_ADVANCE,CONTRACT_AMOUNT,CURR_OVERDUE_DAY,FIRST_REPAY_DATE,REPAY_ACCOUNT_NO,REPAY_ACCT_PHONE,SERVICE_FEE_ACCU,INTEREST_ADVANCE,REPAY_ACCOUNT_NAME,TOTAL_CAPITAL_ACCU,TOTAL_CAPITAL_LEFT,REPAY_FLOATING_RATE,APPROVE_DATE,LEND_DATE
    </sql>


    <!--插入表:AMS_ACCOUNT_BORROW-->
    <insert id="insert">
        <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER">
            SELECT
            LAST_INSERT_ID()
        </selectKey>
        INSERT INTO AMS_ACCOUNT_BORROW(
        ID
        ,BO_ID
        ,ORG_ID
        ,STATUS
        ,USER_ID
        ,CHANNEL
        ,BR_USER_ID
        ,LEND_TIME
        ,LEND_DATE
        ,APPROVE_DATE
        ,RATE_TYPE
        ,APPLY_TIME
        ,CREATED_BY
        ,IS_FULL_FEE
        ,LOAN_USAGE
        ,REPAY_DATE
        ,REPAY_RATE
        ,REPAY_TYPE
        ,UPDATED_BY
        ,CONTRACT_NO
        ,LEND_AMOUNT
        ,LOAN_AMOUNT
        ,APPROVE_TIME
        ,CREATED_TIME
        ,PRODUCT_CODE
        ,PRODUCT_TYPE
        ,RECEIPT_RATE
        ,REPAY_PERIOD
        ,REPAY_STATUS
        ,UPDATED_TIME
        ,CONTRACT_TYPE
        ,INTEREST_ACCU
        ,OVERDUE_TIMES
        ,PLATFORM_RATE
        ,ACCOUNT_AMOUNT
        ,CAPITAL_AMOUNT
        ,LAST_REPAY_DATE
        ,MAX_OVERDUE_DAY
        ,NEXT_REPAY_DATE
        ,PUNISH_FEE_ACCU
        ,REPAY_ACCT_BANK
        ,CAPITAL_ADVANCE
        ,CONTRACT_AMOUNT
        ,CURR_OVERDUE_DAY
        ,FIRST_REPAY_DATE
        ,REPAY_ACCOUNT_NO
        ,REPAY_ACCT_PHONE
        ,SERVICE_FEE_ACCU
        ,INTEREST_ADVANCE
        ,REPAY_ACCOUNT_NAME
        ,TOTAL_CAPITAL_ACCU
        ,TOTAL_CAPITAL_LEFT
        ,REPAY_FLOATING_RATE
        )VALUES(
        #{id,jdbcType=BIGINT}
        , #{boId,jdbcType=VARCHAR}
        , #{orgId,jdbcType=BIGINT}
        , #{status,jdbcType=VARCHAR}
        , #{userId,jdbcType=VARCHAR}
        , #{channel,jdbcType=VARCHAR}
        , #{brUserId,jdbcType=VARCHAR}
        , #{lendTime,jdbcType=TIMESTAMP}
        , #{lendDate,jdbcType=DATE}
        , #{approveDate,jdbcType=DATE}
        , #{rateType,jdbcType=VARCHAR}
        , #{applyTime,jdbcType=TIMESTAMP}
        , #{createdBy,jdbcType=VARCHAR}
        , #{isFullFee,jdbcType=VARCHAR}
        , #{loanUsage,jdbcType=VARCHAR}
        , #{repayDate,jdbcType=VARCHAR}
        , #{repayRate,jdbcType=DECIMAL}
        , #{repayType,jdbcType=VARCHAR}
        , #{updatedBy,jdbcType=VARCHAR}
        , #{contractNo,jdbcType=VARCHAR}
        , #{lendAmount,jdbcType=DECIMAL}
        , #{loanAmount,jdbcType=DECIMAL}
        , #{approveTime,jdbcType=TIMESTAMP}
        , #{createdTime,jdbcType=TIMESTAMP}
        , #{productCode,jdbcType=VARCHAR}
        , #{productType,jdbcType=VARCHAR}
        , #{receiptRate,jdbcType=DECIMAL}
        , #{repayPeriod,jdbcType=VARCHAR}
        , #{repayStatus,jdbcType=VARCHAR}
        , #{updatedTime,jdbcType=TIMESTAMP}
        , #{contractType,jdbcType=VARCHAR}
        , #{interestAccu,jdbcType=DECIMAL}
        , #{overdueTimes,jdbcType=VARCHAR}
        , #{platformRate,jdbcType=DECIMAL}
        , #{accountAmount,jdbcType=DECIMAL}
        , #{capitalAmount,jdbcType=DECIMAL}
        , #{lastRepayDate,jdbcType=DATE}
        , #{maxOverdueDay,jdbcType=VARCHAR}
        , #{nextRepayDate,jdbcType=DATE}
        , #{punishFeeAccu,jdbcType=DECIMAL}
        , #{repayAcctBank,jdbcType=VARCHAR}
        , #{capitalAdvance,jdbcType=DECIMAL}
        , #{contractAmount,jdbcType=DECIMAL}
        , #{currOverdueDay,jdbcType=VARCHAR}
        , #{firstRepayDate,jdbcType=DATE}
        , #{repayAccountNo,jdbcType=VARCHAR}
        , #{repayAcctPhone,jdbcType=VARCHAR}
        , #{serviceFeeAccu,jdbcType=DECIMAL}
        , #{interestAdvance,jdbcType=DECIMAL}
        , #{repayAccountName,jdbcType=VARCHAR}
        , #{totalCapitalAccu,jdbcType=DECIMAL}
        , #{totalCapitalLeft,jdbcType=DECIMAL}
        , #{repayFloatingRate,jdbcType=DECIMAL}
        )
    </insert>

    <!--更新表:AMS_ACCOUNT_BORROW-->
    <update id="update">
        UPDATE /*MS-AMS-ACCOUNT-BORROW-UPDATE*/ AMS_ACCOUNT_BORROW
        SET
            BO_ID           = #{boId,jdbcType=VARCHAR}
            ,STATUS          = #{status,jdbcType=VARCHAR}
            ,USER_ID         = #{userId,jdbcType=VARCHAR}
            ,CHANNEL         = #{channel,jdbcType=VARCHAR}
            ,BR_USER_ID      = #{brUserId,jdbcType=VARCHAR}
            ,LEND_TIME       = #{lendTime,jdbcType=TIMESTAMP}
            ,LEND_DATE       = #{lendDate,jdbcType=DATE}
            ,APPROVE_DATE   = #{approveDate,jdbcType=DATE}
            ,RATE_TYPE       = #{rateType,jdbcType=VARCHAR}
            ,APPLY_TIME      = #{applyTime,jdbcType=TIMESTAMP}
            ,CREATED_BY      = #{createdBy,jdbcType=VARCHAR}
            ,IS_FULL_FEE     = #{isFullFee,jdbcType=VARCHAR}
            ,LOAN_USAGE      = #{loanUsage,jdbcType=VARCHAR}
            ,REPAY_DATE      = #{repayDate,jdbcType=VARCHAR}
            ,REPAY_RATE      = #{repayRate,jdbcType=DECIMAL}
            ,REPAY_TYPE      = #{repayType,jdbcType=VARCHAR}
            ,UPDATED_BY      = #{updatedBy,jdbcType=VARCHAR}
            ,CONTRACT_NO     = #{contractNo,jdbcType=VARCHAR}
            ,LEND_AMOUNT     = #{lendAmount,jdbcType=DECIMAL}
            ,LOAN_AMOUNT     = #{loanAmount,jdbcType=DECIMAL}
            ,APPROVE_TIME    = #{approveTime,jdbcType=TIMESTAMP}
            ,CREATED_TIME    = #{createdTime,jdbcType=TIMESTAMP}
            ,PRODUCT_CODE    = #{productCode,jdbcType=VARCHAR}
            ,PRODUCT_TYPE    = #{productType,jdbcType=VARCHAR}
            ,RECEIPT_RATE    = #{receiptRate,jdbcType=DECIMAL}
            ,REPAY_PERIOD    = #{repayPeriod,jdbcType=VARCHAR}
            ,REPAY_STATUS    = #{repayStatus,jdbcType=VARCHAR}
            ,UPDATED_TIME    = #{updatedTime,jdbcType=TIMESTAMP}
            ,CONTRACT_TYPE   = #{contractType,jdbcType=VARCHAR}
            ,INTEREST_ACCU   = #{interestAccu,jdbcType=DECIMAL}
            ,OVERDUE_TIMES   = #{overdueTimes,jdbcType=VARCHAR}
            ,PLATFORM_RATE   = #{platformRate,jdbcType=DECIMAL}
            ,ACCOUNT_AMOUNT  = #{accountAmount,jdbcType=DECIMAL}
            ,CAPITAL_AMOUNT  = #{capitalAmount,jdbcType=DECIMAL}
            ,LAST_REPAY_DATE = #{lastRepayDate,jdbcType=DATE}
            ,MAX_OVERDUE_DAY = #{maxOverdueDay,jdbcType=VARCHAR}
            ,NEXT_REPAY_DATE = #{nextRepayDate,jdbcType=DATE}
            ,PUNISH_FEE_ACCU = #{punishFeeAccu,jdbcType=DECIMAL}
            ,REPAY_ACCT_BANK = #{repayAcctBank,jdbcType=VARCHAR}
            ,CAPITAL_ADVANCE = #{capitalAdvance,jdbcType=DECIMAL}
            ,CONTRACT_AMOUNT = #{contractAmount,jdbcType=DECIMAL}
            ,CURR_OVERDUE_DAY = #{currOverdueDay,jdbcType=VARCHAR}
            ,FIRST_REPAY_DATE = #{firstRepayDate,jdbcType=DATE}
            ,REPAY_ACCOUNT_NO = #{repayAccountNo,jdbcType=VARCHAR}
            ,REPAY_ACCT_PHONE = #{repayAcctPhone,jdbcType=VARCHAR}
            ,SERVICE_FEE_ACCU = #{serviceFeeAccu,jdbcType=DECIMAL}
            ,INTEREST_ADVANCE = #{interestAdvance,jdbcType=DECIMAL}
            ,REPAY_ACCOUNT_NAME = #{repayAccountName,jdbcType=VARCHAR}
            ,TOTAL_CAPITAL_ACCU = #{totalCapitalAccu,jdbcType=DECIMAL}
            ,TOTAL_CAPITAL_LEFT = #{totalCapitalLeft,jdbcType=DECIMAL}
            ,REPAY_FLOATING_RATE = #{repayFloatingRate,jdbcType=DECIMAL}
        WHERE
            ID              = #{id,jdbcType=BIGINT}
            AND ORG_ID          = #{orgId,jdbcType=BIGINT}
    </update>

    <!--根据主键删除数据:AMS_ACCOUNT_BORROW-->
    <delete id="deleteByPrimary">
        DELETE /*MS-AMS-ACCOUNT-BORROW-DELETEBYPRIMARY*/ FROM
            AMS_ACCOUNT_BORROW
        WHERE
            ID = #{id,jdbcType=BIGINT}
            AND ORG_ID = #{orgId,jdbcType=BIGINT}
    </delete>

    <!--根据主键获取数据:AMS_ACCOUNT_BORROW-->
    <select id="getByPrimary" resultMap="BaseResultMap">
        SELECT /*MS-AMS-ACCOUNT-BORROW-GETBYPRIMARY*/
        <include refid="Base_Column_List"/>
        FROM AMS_ACCOUNT_BORROW
        WHERE
        ID = #{id,jdbcType=BIGINT}
        AND ORG_ID = #{orgId,jdbcType=BIGINT}
    </select>

    <!--queryAccountInfo-->
    <select id="queryAccountInfo" resultMap="BaseResultMap">
        SELECT /*MS-AMS-ACCOUNT-BORROW-QUERYACCOUNTINFO*/
        <include refid="Base_Column_List"/>
        FROM AMS_ACCOUNT_BORROW
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=BIGINT}
        </if>
    </select>

    <update id="updateRepayStatus">
        UPDATE AMS_ACCOUNT_BORROW SET
        repay_status = #{repayStatus,jdbcType=VARCHAR}
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=INTEGER}
        </if>
    </update>

    <update id="updateBorrowSuccess">
        UPDATE AMS_ACCOUNT_BORROW SET
        NEXT_REPAY_DATE = #{nextRepayDate,jdbcType=DATE}
        ,TOTAL_CAPITAL_LEFT = #{totalCapitalLeft,jdbcType=DECIMAL}
        ,TOTAL_CAPITAL_ACCU = #{totalCapitalAccu,jdbcType=DECIMAL}
        ,INTEREST_ACCU = #{interestAccu,jdbcType=DECIMAL}
        ,SERVICE_FEE_ACCU = #{serviceFeeAccu,jdbcType=DECIMAL}
        ,PUNISH_FEE_ACCU = #{punishFeeAccu,jdbcType=DECIMAL}
        ,NEXT_REPAY_DATE = #{nextRepayDate,jdbcType=DATE}
        ,UPDATED_TIME = #{updatedTime,jdbcType=TIMESTAMP}
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=INTEGER}
        </if>
    </update>

    <update id="updateBorrowFail">
        UPDATE AMS_ACCOUNT_BORROW SET
        repay_status = #{repayStatus,jdbcType=VARCHAR}
        ,OVERDUE_TIMES = #{overdueTimes,jdbcType=VARCHAR}
        ,UPDATED_TIME = #{updatedTime,jdbcType=TIMESTAMP}
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=INTEGER}
        </if>
    </update>

    <update id="updateRepayRate">
        UPDATE AMS_ACCOUNT_BORROW SET
        repay_rate=#{repayRate,jdbcType=VARCHAR},
        INTEREST_ADVANCE=#{interestAdvance,jdbcType=DECIMAL},
        service_fee_accu=#{serviceFeeAccu,jdbcType=DECIMAL}
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=INTEGER}
        </if>
    </update>

    <update id="updateStatus">
        UPDATE AMS_ACCOUNT_BORROW SET
        STATUS=#{status,jdbcType=VARCHAR}
        WHERE status=1
        <if test="userId !='' and userId !=null">
            AND USER_ID = #{userId,jdbcType=VARCHAR}
        </if>
        <if test="boId !='' and boId !=null">
            AND BO_ID = #{boId,jdbcType=VARCHAR}
        </if>
        <if test="orgId !='' and orgId !=null">
            AND ORG_ID = #{orgId,jdbcType=INTEGER}
        </if>
    </update>

</mapper>
